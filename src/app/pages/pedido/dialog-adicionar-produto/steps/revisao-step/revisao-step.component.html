<section class="rev-section">
  <div class="rev-grid">
    <div class="rev-field">
      <div class="rev-label">Produto</div>
      <div class="rev-value">{{ produtoBase?.nome || '—' }}</div>
      <div class="rev-subtle" *ngIf="produtoBase?.descricao">{{ produtoBase?.descricao }}</div>
    </div>
    <div class="rev-field">
      <div class="rev-label">Variação</div>
      <div class="rev-chipline" *ngIf="variacaoChips.length; else semVar">
        <span class="rev-chip" *ngFor="let chip of variacaoChips">{{ chip }}</span>
      </div>
      <ng-template #semVar>—</ng-template>
      <div class="rev-subtle" *ngIf="baseResumoTexto">({{ baseResumoTexto }})</div>
    </div>
  </div>
</section>

<section class="rev-section">
  <div class="rev-label">Itens</div>
  <div class="rev-table">
    <ng-template #dash>—</ng-template>

    <div class="rev-row rev-head">
      <div>Item</div>
      <div class="text-center">Qtd</div>
      <div class="text-right">Unitário</div>
      <div class="text-right">Total</div>
    </div>

    <div class="rev-row">
      <div>
        <div class="rev-item">Produto (variação)</div>
        <div class="rev-subtle" *ngIf="baseResumoTexto">{{ baseResumoTexto }}</div>
      </div>

      <div class="text-center">{{ baseQtd }}</div>

      <div class="text-right">
        <ng-container *ngIf="baseUnit !== null; else dash">{{ moneyFn(baseUnit) }}</ng-container>
      </div>

      <div class="text-right">
        <ng-container *ngIf="baseSubtotal !== null; else dash">{{ moneyFn(baseSubtotal) }}</ng-container>
      </div>
    </div>

    <div class="rev-row" *ngFor="let a of acabamentosSelecionadosDetalhe; trackBy: trackById">
      <div>
        <div class="rev-item">Acabamento: {{ a.nome }}</div>
        <div class="rev-subtle" *ngIf="a.descricao">{{ a.descricao }}</div>
      </div>

      <div class="text-center">1</div>

      <div class="text-right">
        <ng-container *ngIf="unitFromPrecoFn(a.preco) as u; else dash">{{ moneyFn(u) }}</ng-container>
      </div>

      <div class="text-right">
        <ng-container *ngIf="unitFromPrecoFn(a.preco) as u; else dash">{{ moneyFn(u) }}</ng-container>
      </div>
    </div>

    <div class="rev-row" *ngFor="let s of servicosSelecionadosDetalhe; trackBy: trackById">
      <div>
        <div class="rev-item">Serviço: {{ s.nome }}</div>
        <div class="rev-subtle" *ngIf="s.descricao">{{ s.descricao }}</div>
      </div>

      <div class="text-center">1</div>

      <div class="text-right">
        <ng-container *ngIf="unitFromPrecoFn(s.preco) as u; else dash">{{ moneyFn(u) }}</ng-container>
      </div>

      <div class="text-right">
        <ng-container *ngIf="unitFromPrecoFn(s.preco) as u; else dash">{{ moneyFn(u) }}</ng-container>
      </div>
    </div>
  </div>
</section>

<section class="rev-section rev-summary">
  <div class="rev-line">
    <span>Subtotal do produto</span>
    <span>{{ baseSubtotal !== null ? moneyFn(baseSubtotal) : '—' }}</span>
  </div>
  <div class="rev-line">
    <span>Adicionais (fixos)</span>
    <span>{{ moneyFn(adicionaisFixosSubtotal) }}</span>
  </div>

  <mat-divider></mat-divider>

  <div class="rev-total">
    <span>Total</span>
    <span>{{ totalConhecido !== null ? moneyFn(totalConhecido) : '—' }}</span>
  </div>

  <div class="rev-note" *ngIf="qtdeVariaveis > 0">
    <mat-icon class="m-r-4" inline>info</mat-icon>
    Existem {{ qtdeVariaveis }} item(ns) com preço variável (ex.: por hora, por metro ou
    faixas). Eles não foram somados ao total e podem alterar o valor final.
  </div>
</section>
