<mat-card class="cardWithShadow">
  <app-card-header
    [titulo]="isEditMode ? 'Editar Usuário' : 'Novo Usuário'"
    botaoTexto="Voltar"
    botaoIcone="arrow_back"
    botaoCor="primary"
    [botaoRota]="['/page/usuarios/listar']"
    [mostrarDivisor]="true">
  </app-card-header>

  <mat-card-content>
    <form [formGroup]="form" (ngSubmit)="onSubmit()">
      <div class="row g-3">
        <div class="col-12">
          <mat-label class="f-s-14 f-w-600 m-b-8 d-block">Nome</mat-label>
          <mat-form-field appearance="outline" class="w-100">
            <input matInput formControlName="nome" placeholder="Digite o nome completo" />
            @if (form.get('nome')?.invalid && form.get('nome')?.touched) {
              <mat-error>{{ getErrorMessage('nome') }}</mat-error>
            }
          </mat-form-field>
        </div>

        <div class="col-md-6">
          <mat-label class="f-s-14 f-w-600 m-b-8 d-block">E-mail</mat-label>
          <mat-form-field appearance="outline" class="w-100">
            <input matInput type="email" formControlName="username" placeholder="exemplo@email.com" />
            @if (form.get('username')?.invalid && form.get('username')?.touched) {
              <mat-error>{{ getErrorMessage('username') }}</mat-error>
            }
          </mat-form-field>
        </div>

        @if (!isEditMode) {
          <div class="col-md-6">
            <mat-label class="f-s-14 f-w-600 m-b-8 d-block">Senha</mat-label>
            <mat-form-field appearance="outline" class="w-100">
              <input matInput type="password" formControlName="senha" placeholder="Digite a senha" />
              @if (form.get('senha')?.invalid && form.get('senha')?.touched) {
                <mat-error>{{ getErrorMessage('senha') }}</mat-error>
              }
            </mat-form-field>
          </div>
        }

        <div class="col-md-6">
          <mat-label class="f-s-14 f-w-600 m-b-8 d-block">Perfil</mat-label>
          <mat-form-field appearance="outline" class="w-100">
            <mat-select formControlName="perfilId">
              <mat-option *ngFor="let perfil of perfis" [value]="perfil.id">
                {{ perfil.nome }}
              </mat-option>
            </mat-select>
            @if (form.get('perfilId')?.invalid && form.get('perfilId')?.touched) {
              <mat-error>{{ getErrorMessage('perfilId') }}</mat-error>
            }
          </mat-form-field>
        </div>

        @if (isEditMode) {
          <div class="col-md-6 d-flex align-items-center">
            <mat-slide-toggle formControlName="ativo">
              {{ form.get('ativo')?.value ? 'Usuário Ativo' : 'Usuário Inativo' }}
            </mat-slide-toggle>
          </div>
        }
      </div>

      <div class="m-t-30 d-flex gap-2 flex-wrap">
        <a mat-flat-button class="bg-error text-white" [routerLink]="['/page/usuarios/listar']">
          Cancelar
        </a>

        <button mat-flat-button color="primary" type="submit" [disabled]="form.invalid">
          {{ isEditMode ? 'Atualizar Usuário' : 'Salvar Usuário' }}
        </button>
      </div>
    </form>
  </mat-card-content>
</mat-card>
